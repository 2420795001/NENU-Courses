/*
;************************************************************************************************************
;*				        ‘±±‘¾©‘¾«‘ÒÇ‘´ï‘Ê¢‘¿Æ‘¼¼‘ÓÐ‘ÏÞ‘¹«‘Ë¾
;*                                     	     ‘ÑÐ    ‘·¢    ‘²¿
;*
;*                                      http://www.techshine.com
;*
;*--------------------------------------------- ‘ÎÄ‘¼þ‘ÐÅ‘Ï¢ ----------------------------------------------------                                      
;*
;* ‘ÎÄ‘¼þ‘Ãû‘³Æ : target.c	
;* ‘ÎÄ‘¼þ‘¹¦‘ÄÜ : ‘¸Ã‘ÎÄ‘¼þ‘ÎªS3C44B0‘Ó²‘¼þ‘Æ½‘Ì¨‘Åä‘ÖÃ‘¾ß‘Ìå‘º¯‘Êý‘µÄ‘³õ‘Ê¼‘»¯‘¡£
;* ‘²¹‘³ä‘Ëµ‘Ã÷ : 
;*-------------------------------------------- ‘×î‘ÐÂ‘°æ‘±¾‘ÐÅ‘Ï¢ -------------------------------------------------
;* ‘ÐÞ‘¸Ä‘×÷‘Õß : ARM‘¿ª‘·¢‘Ð¡‘×é
;* ‘ÐÞ‘¸Ä‘ÈÕ‘ÆÚ : 2004/04/25
;* ‘°æ‘±¾‘Éù‘Ã÷ : V1.0.1
;*-------------------------------------------- ‘Àú‘Ê·‘°æ‘±¾‘ÐÅ‘Ï¢ -------------------------------------------------
;* ‘ÎÄ‘¼þ‘×÷‘Õß : ARM‘¿ª‘·¢‘Ð¡‘×é
;* ‘´´‘½¨‘ÈÕ‘ÆÚ : 2004/04/20
;* ‘°æ‘±¾‘Éù‘Ã÷ : v1.0.0
;*-----------------------------------------------------------------------------------------------------------
;*-----------------------------------------------------------------------------------------------------------
;************************************************************************************************************
;*/


#include "..\INC\44b.h"
#include "..\INC\target.h"
#include "..\INC\44blib.h"
#include "..\..\kbddriver\keydriver.h"

/*
*************************************************************************************************************
-  
- ‘³Ì‘Ðò‘¶Î‘Ëµ‘Ã÷ : ‘ÒÔ‘ÏÂ‘º¯‘Êý‘Îª‘¸÷‘Òì‘³£‘Ä£‘Ê½‘·þ‘Îñ‘×Ó‘³Ì‘Ðò‘¡£‘Éè‘³É‘ËÀ‘Ñ­‘»·‘ÊÇ‘Îª‘µ÷‘ÊÔ‘ÓÃ‘£¬‘Ò»‘µ©‘·¢‘Éú‘´Ë‘Àà‘Òì‘³£‘£¬‘³Ì‘Ðò‘±ã‘Ìø‘Èë‘Òì‘³£‘Ä£‘Ê½‘·þ‘Îñ
-              ‘×Ó‘³Ì‘Ðò‘£¬‘ÖÕ‘Ö¹‘³Ì‘Ðò‘ÔË‘ÐÐ‘¡£
-
*************************************************************************************************************
*/

void HaltUndef(void)  																				 //‘Î´‘¶¨‘Òå
{
    Uart_Printf(0,"the programm is haltUndefed");
    while(1);
}

void HaltSwi(void)  																				 //‘Èí‘ÖÐ‘¶Ï
{
    Uart_Printf(0,"the programm is haltSWI");
    while(1);
}

void HaltPabort(void)  																			  //‘Ô¤‘È¡‘Ö¸‘ÖÐ‘Ö¹
{
    Uart_Printf(0,"the programm is haltPaborted");
    while(1);
}

void HaltDabort(void)  																			   //‘Êý‘¾Ý‘ÖÐ‘Ö¹
{
    Uart_Printf(0,"the programm is haltdaborted");
    while(1);
}

void HaltFIQ(void)  																				 //‘¿ì‘ÖÐ‘¶Ï
{
    Uart_Printf(0,"the programm is haltdFIQ");
    while(1);
}

/*
*************************************************************************************************************
-
-                                   ‘³Ì‘Ðò‘¶Î‘Ëµ‘Ã÷ : ‘ÒÔ‘ÏÂ‘º¯‘Êý‘¾ù‘Îª‘³õ‘Ê¼‘»¯‘º¯‘Êý
-            
*************************************************************************************************************
*/

/*
*************************************************************************************************************
- ‘º¯‘Êý‘Ãû‘³Æ : Exep_S3cint_Init(void)
- ‘º¯‘Êý‘Ëµ‘Ã÷ : ‘Òì‘³£‘¼°‘ÖÐ‘¶Ï‘¿Ø‘ÖÆ‘Æ÷‘µÄ‘³õ‘Ê¼‘»¯
- ‘Êä‘Èë‘²Î‘Êý : ‘ÎÞ
- ‘Êä‘³ö‘²Î‘Êý : ‘ÎÞ
*************************************************************************************************************
*/
void Exep_S3cINT_Init(void)  
{ 
    int rr,qq;
    pISR_UNDEF  = (unsigned)HaltUndef;
    pISR_SWI    = (unsigned)HaltSwi;
    pISR_PABORT = (unsigned)HaltPabort;
    pISR_DABORT = (unsigned)HaltDabort;
    pISR_FIQ    = (unsigned)HaltFIQ;

    rINTCON = 0x1;           									// ‘Ëù‘ÓÐ‘ÖÐ‘¶Ï‘¾ù‘Ê¹‘ÓÃ‘Ïò‘Á¿‘ÖÐ‘¶Ï‘£¬‘´ò‘¿ª IRQ ,‘½û‘Ö¹ FIQ     
    rINTMOD = 0x00;	  												               // ‘Ëù‘ÓÐ‘Ä£‘Ê½‘Åä‘ÖÃ‘Îª IRQ ‘Ä£‘Ê½
    rINTMSK = 0x07ffffff;											                          // ‘ÆÁ‘±Î‘Ëù‘ÓÐ‘ÖÐ‘¶Ï
    
    rr = rI_ISPC;
    rr = rINTPND;
    rr = rEXTINPND;
    rEXTINPND = 1;
    rI_ISPC = 0x3ffffff;                                        //‘ÖÐ‘¶Ï‘Çå‘³ý‘£»
    rr = rEXTINPND;
    qq = rINTPND;
}

/*
*************************************************************************************************************
- ‘º¯‘Êý‘Ãû‘³Æ : Cache_Init(void)
- ‘º¯‘Êý‘Ëµ‘Ã÷ : S3C44B0‘ÄÚ‘²¿‘»º‘´æ‘µÄ‘³õ‘Ê¼‘»¯‘³Ì‘Ðò
- ‘Êä‘Èë‘²Î‘Êý : ‘ÎÞ
- ‘Êä‘³ö‘²Î‘Êý : ‘ÎÞ
*************************************************************************************************************
*/														
void Cache_Init(void)
{
    rSYSCFG = SYSCFG_8KB;
    //rNCACHBE0 = 0x20001c00;								                                      
    rNCACHBE1 = 0xe0003000;
}


/*
*************************************************************************************************************
- ‘º¯‘Êý‘Ãû‘³Æ : TargetInit(void)
- ‘º¯‘Êý‘Ëµ‘Ã÷ : ‘Ä¿‘±ê‘°å‘³õ‘Ê¼‘»¯‘³Ì‘Ðò,‘Ö÷‘º¯‘Êý‘ÖÐ‘Ö»‘Ðè‘µ÷‘ÓÃ‘´Ë‘º¯‘Êý‘£¬‘¼´‘¿É‘Íê‘³É‘Ä¿‘±ê‘°å‘µÄ‘³õ‘Ê¼‘»¯
- ‘Êä‘Èë‘²Î‘Êý : ‘ÎÞ
- ‘Êä‘³ö‘²Î‘Êý : ‘ÎÞ
*************************************************************************************************************
*/
void Target_Init(void)
{
    Uart_Init(0,115200,0);
    Port_Init();
    Exep_S3cINT_Init();
    
    Cache_Init();
    KeyINT_Init();
    StartInterrupt(); 		                              //‘¿ª‘ÖÐ‘¶Ï‘£¬‘ÔÚ‘´Ë‘Ö®‘Ç°‘¶¼‘ÊÇ‘¹Ø‘ÖÐ‘¶Ï‘×´‘Ì¬‘£¬‘ÔÚ44binit.s‘ÖÐ‘¶¨‘Òå
}
/*
*************************************************************************************************************
*-													‘½á‘Êø‘ÎÄ‘¼þ                                               -*
*************************************************************************************************************
*/
